//var po = org.polymaps;

//var map = po.map()
    //.container(document.getElementById("map").appendChild(po.svg("svg")))
    map.zoom(3)
    .zoomRange([3, 10]);
map.on("move", update2);

//The variables for the display
  //TODO this has to be furnished by scala !
  //Maybe even 3 different lists actually ... nope ?
  //We expect {"clusters": [{"centers": [{"x":_, "y":_, "r":_}]}]} where all vars are in geoCoordinates

/*var rawData = JSON.parse('{"clusters": [{"centers": [{"x": 37.787, "y": -122.228, "r": 37.60},{"x": 46.5198, "y": 6.6335, "r": 46.190}, {"x": 37.787, "y": -121.228, "r": 37.60}, {"x": 37.8, "y": -122.228, "r": 37.90}]},{"centers": [{"x": 37.787, "y": -122.228, "r": 37.60}]},{"centers": [{"x": 37.787, "y": -122.228, "r": 37.60}]},{"centers": [{"x": 37.787, "y": -122.228, "r": 37.60}]},{"centers": [{"x": 37.787, "y": -122.228, "r": 37.60}]},{"centers": [{"x": 37.787, "y": -122.228, "r": 37.60}]},{"centers": [{"x": 37.787, "y": -122.228, "r": 37.60}]},{"centers": [{"x": 37.787, "y": -122.228, "r": 37.60}]},{"centers": [{"x": 37.787, "y": -122.228, "r": 37.60}]},{"centers": [{"x": 37.787, "y": -122.228, "r": 37.60}]}]}');*/
var testData = JSON.parse('{"centers": [{"x": 37.787, "y": -122.228, "r": 37.60}]}')
//var rawData1 = {"clusters": [testData, testData, testData, testData, testData, testData, testData, testData, testData, testData]};
var rawData1 = JSON.parse('{"clusters": [{"centers": [{"x": 34.025,"y": -123.1, "r": 35.3, "d": 32.0},{"x": 41.67499999999999,"y": -106.29999999999998, "r": 42.94999999999999, "d": 21.0},{"x": 44.22499999999999,"y": -85.29999999999998, "r": 45.499999999999986, "d": 36.0},{"x": 23.825000000000003,"y": -106.29999999999998, "r": 25.1, "d": 7.0},{"x": 26.375,"y": -102.1, "r": 27.650000000000002, "d": 47.0},{"x": 44.22499999999999,"y": -114.69999999999999, "r": 45.499999999999986, "d": 18.0},{"x": 34.025,"y": -81.09999999999997, "r": 35.3, "d": 100.0},{"x": 31.475,"y": -93.69999999999999, "r": 32.75, "d": 27.0},{"x": 49.32499999999998,"y": -97.89999999999998, "r": 50.59999999999998, "d": 43.0},{"x": 23.825000000000003,"y": -81.09999999999997, "r": 25.1, "d": 100.0},{"x": 41.67499999999999,"y": -123.1, "r": 42.94999999999999, "d": 9.0},{"x": 36.574999999999996,"y": -110.5, "r": 37.849999999999994, "d": 11.0},{"x": 36.574999999999996,"y": -123.1, "r": 37.849999999999994, "d": 99.0},{"x": 39.12499999999999,"y": -106.29999999999998, "r": 40.39999999999999, "d": 97.0},{"x": 46.774999999999984,"y": -97.89999999999998, "r": 48.04999999999998, "d": 41.0},{"x": 31.475,"y": -106.29999999999998, "r": 32.75, "d": 14.0},{"x": 39.12499999999999,"y": -118.9, "r": 40.39999999999999, "d": 99.0},{"x": 41.67499999999999,"y": -81.09999999999997, "r": 42.94999999999999, "d": 100.0},{"x": 36.574999999999996,"y": -85.29999999999998, "r": 37.849999999999994, "d": 55.0},{"x": 21.275,"y": -97.89999999999998, "r": 22.55, "d": 100.0},{"x": 34.025,"y": -89.49999999999997, "r": 35.3, "d": 100.0},{"x": 44.22499999999999,"y": -110.5, "r": 45.499999999999986, "d": 18.0},{"x": 39.12499999999999,"y": -97.89999999999998, "r": 40.39999999999999, "d": 44.0},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 45.499999999999986, "d": 99.0},{"x": 31.475,"y": -102.1, "r": 32.75, "d": 40.0},{"x": 41.67499999999999,"y": -89.49999999999997, "r": 42.94999999999999, "d": 98.0},{"x": 26.375,"y": -81.09999999999997, "r": 27.650000000000002, "d": 100.0},{"x": 28.925000000000004,"y": -97.89999999999998, "r": 30.200000000000003, "d": 100.0},{"x": 31.475,"y": -97.89999999999998, "r": 32.75, "d": 100.0},{"x": 39.12499999999999,"y": -110.5, "r": 40.39999999999999, "d": 25.0},{"x": 21.275,"y": -102.1, "r": 22.55, "d": 100.0},{"x": 36.574999999999996,"y": -114.69999999999999, "r": 37.849999999999994, "d": 100.0},{"x": 21.275,"y": -81.09999999999997, "r": 22.55, "d": 100.0},{"x": 39.12499999999999,"y": -81.09999999999997, "r": 40.39999999999999, "d": 99.0},{"x": 39.12499999999999,"y": -89.49999999999997, "r": 40.39999999999999, "d": 100.0}]}, {"centers": [{"x": 36.574999999999996,"y": -123.1, "r": 42.94999999999999, "d": 9.333333},{"x": 42.94999999999999,"y": -93.69999999999999, "r": 45.499999999999986, "d": 13.8},{"x": 32.75,"y": -87.39999999999998, "r": 37.849999999999994, "d": 11.375},{"x": 25.1,"y": -104.19999999999999, "r": 27.650000000000002, "d": 6.4583335},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 39.8},{"x": 21.275,"y": -108.39999999999999, "r": 22.55, "d": 10.1},{"x": 48.04999999999998,"y": -108.39999999999999, "r": 50.59999999999998, "d": 4.45}]}, {"centers": [{"x": 36.574999999999996,"y": -123.1, "r": 42.94999999999999, "d": 9.333333},{"x": 42.94999999999999,"y": -93.69999999999999, "r": 45.499999999999986, "d": 13.8},{"x": 32.75,"y": -87.39999999999998, "r": 37.849999999999994, "d": 11.375},{"x": 25.1,"y": -104.19999999999999, "r": 27.650000000000002, "d": 6.4583335},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 39.8},{"x": 21.275,"y": -108.39999999999999, "r": 22.55, "d": 10.1},{"x": 48.04999999999998,"y": -108.39999999999999, "r": 50.59999999999998, "d": 4.45}]}, {"centers": [{"x": 36.574999999999996,"y": -123.1, "r": 42.94999999999999, "d": 9.333333},{"x": 42.94999999999999,"y": -93.69999999999999, "r": 45.499999999999986, "d": 13.8},{"x": 32.75,"y": -87.39999999999998, "r": 37.849999999999994, "d": 11.375},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 39.8},{"x": 21.275,"y": -108.39999999999999, "r": 22.55, "d": 10.1},{"x": 26.375,"y": -104.19999999999999, "r": 27.650000000000002, "d": 12.25},{"x": 48.04999999999998,"y": -108.39999999999999, "r": 50.59999999999998, "d": 4.45},{"x": 23.825000000000003,"y": -104.19999999999999, "r": 25.1, "d": 9.0}]}, {"centers": [{"x": 36.574999999999996,"y": -123.1, "r": 42.94999999999999, "d": 9.333333},{"x": 42.94999999999999,"y": -93.69999999999999, "r": 45.499999999999986, "d": 13.8},{"x": 32.75,"y": -87.39999999999998, "r": 37.849999999999994, "d": 11.375},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 39.8},{"x": 21.275,"y": -108.39999999999999, "r": 22.55, "d": 10.1},{"x": 26.375,"y": -104.19999999999999, "r": 27.650000000000002, "d": 12.25},{"x": 48.04999999999998,"y": -108.39999999999999, "r": 50.59999999999998, "d": 4.45},{"x": 23.825000000000003,"y": -104.19999999999999, "r": 25.1, "d": 9.0}]}, {"centers": [{"x": 36.574999999999996,"y": -123.1, "r": 42.94999999999999, "d": 9.333333},{"x": 42.94999999999999,"y": -93.69999999999999, "r": 45.499999999999986, "d": 13.8},{"x": 32.75,"y": -87.39999999999998, "r": 37.849999999999994, "d": 11.375},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 39.8},{"x": 48.04999999999998,"y": -97.89999999999998, "r": 50.59999999999998, "d": 8.9},{"x": 45.499999999999986,"y": -121.0, "r": 48.04999999999998, "d": 2.375},{"x": 21.275,"y": -108.39999999999999, "r": 22.55, "d": 10.1},{"x": 26.375,"y": -104.19999999999999, "r": 27.650000000000002, "d": 12.25},{"x": 23.825000000000003,"y": -104.19999999999999, "r": 25.1, "d": 9.0}]}, {"centers": [{"x": 36.574999999999996,"y": -114.69999999999999, "r": 37.849999999999994, "d": 30.0},{"x": 32.75,"y": -123.1, "r": 35.3, "d": 5.3333335},{"x": 42.94999999999999,"y": -93.69999999999999, "r": 45.499999999999986, "d": 13.8},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 39.8},{"x": 48.04999999999998,"y": -97.89999999999998, "r": 50.59999999999998, "d": 8.9},{"x": 45.499999999999986,"y": -121.0, "r": 48.04999999999998, "d": 2.375},{"x": 28.925000000000004,"y": -108.39999999999999, "r": 30.200000000000003, "d": 10.0},{"x": 40.39999999999999,"y": -125.2, "r": 42.94999999999999, "d": 2.25},{"x": 21.275,"y": -108.39999999999999, "r": 22.55, "d": 10.1},{"x": 32.75,"y": -83.19999999999997, "r": 37.849999999999994, "d": 19.375},{"x": 26.375,"y": -104.19999999999999, "r": 27.650000000000002, "d": 12.25},{"x": 23.825000000000003,"y": -104.19999999999999, "r": 25.1, "d": 9.0},{"x": 35.3,"y": -87.39999999999998, "r": 37.849999999999994, "d": 19.375}]}, {"centers": [{"x": 36.574999999999996,"y": -114.69999999999999, "r": 37.849999999999994, "d": 30.0},{"x": 32.75,"y": -123.1, "r": 35.3, "d": 5.3333335},{"x": 42.94999999999999,"y": -93.69999999999999, "r": 45.499999999999986, "d": 13.8},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 39.8},{"x": 48.04999999999998,"y": -97.89999999999998, "r": 50.59999999999998, "d": 8.9},{"x": 45.499999999999986,"y": -121.0, "r": 48.04999999999998, "d": 2.375},{"x": 28.925000000000004,"y": -108.39999999999999, "r": 30.200000000000003, "d": 10.0},{"x": 40.39999999999999,"y": -125.2, "r": 42.94999999999999, "d": 2.25},{"x": 21.275,"y": -108.39999999999999, "r": 22.55, "d": 10.1},{"x": 32.75,"y": -83.19999999999997, "r": 37.849999999999994, "d": 19.375},{"x": 23.825000000000003,"y": -102.1, "r": 25.1, "d": 9.818182},{"x": 26.375,"y": -99.99999999999999, "r": 27.650000000000002, "d": 14.7},{"x": 35.3,"y": -87.39999999999998, "r": 37.849999999999994, "d": 19.375}]}, {"centers": [{"x": 36.574999999999996,"y": -114.69999999999999, "r": 37.849999999999994, "d": 30.0},{"x": 32.75,"y": -123.1, "r": 35.3, "d": 5.3333335},{"x": 28.925000000000004,"y": -104.19999999999999, "r": 30.200000000000003, "d": 12.5},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 39.8},{"x": 45.499999999999986,"y": -121.0, "r": 48.04999999999998, "d": 2.375},{"x": 42.94999999999999,"y": -89.49999999999997, "r": 45.499999999999986, "d": 22.333334},{"x": 40.39999999999999,"y": -125.2, "r": 42.94999999999999, "d": 2.25},{"x": 26.375,"y": -95.79999999999998, "r": 27.650000000000002, "d": 18.375},{"x": 32.75,"y": -83.19999999999997, "r": 37.849999999999994, "d": 19.375},{"x": 48.04999999999998,"y": -99.99999999999999, "r": 50.59999999999998, "d": 11.125},{"x": 23.825000000000003,"y": -87.39999999999998, "r": 25.1, "d": 25.0},{"x": 21.275,"y": -104.19999999999999, "r": 22.55, "d": 12.625},{"x": 35.3,"y": -87.39999999999998, "r": 37.849999999999994, "d": 19.375}]}, {"centers": [{"x": 31.475,"y": -102.1, "r": 32.75, "d": 36.2},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 39.8},{"x": 40.39999999999999,"y": -125.2, "r": 42.94999999999999, "d": 2.25},{"x": 34.025,"y": -123.1, "r": 35.3, "d": 10.666667},{"x": 35.3,"y": -83.19999999999997, "r": 37.849999999999994, "d": 38.75},{"x": 27.650000000000002,"y": -99.99999999999999, "r": 30.200000000000003, "d": 36.75},{"x": 39.12499999999999,"y": -110.5, "r": 45.499999999999986, "d": 10.8},{"x": 25.1,"y": -81.09999999999997, "r": 30.200000000000003, "d": 25.0},{"x": 44.22499999999999,"y": -121.0, "r": 45.499999999999986, "d": 4.75},{"x": 26.375,"y": -87.39999999999998, "r": 27.650000000000002, "d": 25.0},{"x": 36.574999999999996,"y": -114.69999999999999, "r": 42.94999999999999, "d": 20.0},{"x": 23.825000000000003,"y": -87.39999999999998, "r": 25.1, "d": 25.0},{"x": 45.499999999999986,"y": -116.8, "r": 48.04999999999998, "d": 4.75},{"x": 42.94999999999999,"y": -87.39999999999998, "r": 45.499999999999986, "d": 33.5},{"x": 49.32499999999998,"y": -99.99999999999999, "r": 50.59999999999998, "d": 11.0},{"x": 41.67499999999999,"y": -106.29999999999998, "r": 48.04999999999998, "d": 24.4},{"x": 21.275,"y": -97.89999999999998, "r": 22.55, "d": 20.0}]}, {"centers": [{"x": 31.475,"y": -108.39999999999999, "r": 32.75, "d": 7.0},{"x": 27.650000000000002,"y": -81.09999999999997, "r": 30.200000000000003, "d": 50.0},{"x": 21.275,"y": -104.19999999999999, "r": 22.55, "d": 50.0},{"x": 42.94999999999999,"y": -85.29999999999998, "r": 45.499999999999986, "d": 18.0},{"x": 44.22499999999999,"y": -116.8, "r": 45.499999999999986, "d": 9.5},{"x": 25.1,"y": -81.09999999999997, "r": 27.650000000000002, "d": 50.0},{"x": 45.499999999999986,"y": -85.29999999999998, "r": 48.04999999999998, "d": 18.0},{"x": 31.475,"y": -93.69999999999999, "r": 32.75, "d": 27.0},{"x": 27.650000000000002,"y": -97.89999999999998, "r": 30.200000000000003, "d": 50.0},{"x": 31.475,"y": -99.99999999999999, "r": 32.75, "d": 70.0},{"x": 40.39999999999999,"y": -81.09999999999997, "r": 42.94999999999999, "d": 99.5},{"x": 23.825000000000003,"y": -83.19999999999997, "r": 25.1, "d": 50.0},{"x": 42.94999999999999,"y": -110.5, "r": 45.499999999999986, "d": 9.0},{"x": 21.275,"y": -95.79999999999998, "r": 22.55, "d": 50.0},{"x": 35.3,"y": -123.1, "r": 37.849999999999994, "d": 65.5},{"x": 39.12499999999999,"y": -121.0, "r": 40.39999999999999, "d": 49.5},{"x": 34.025,"y": -83.19999999999997, "r": 35.3, "d": 50.0},{"x": 48.04999999999998,"y": -97.89999999999998, "r": 50.59999999999998, "d": 42.0},{"x": 34.025,"y": -87.39999999999998, "r": 35.3, "d": 50.0},{"x": 40.39999999999999,"y": -97.89999999999998, "r": 42.94999999999999, "d": 22.0},{"x": 40.39999999999999,"y": -89.49999999999997, "r": 42.94999999999999, "d": 99.0},{"x": 26.375,"y": -83.19999999999997, "r": 27.650000000000002, "d": 50.0},{"x": 34.025,"y": -91.59999999999998, "r": 35.3, "d": 50.0},{"x": 28.925000000000004,"y": -95.79999999999998, "r": 30.200000000000003, "d": 50.0},{"x": 22.55,"y": -102.1, "r": 25.1, "d": 50.0},{"x": 35.3,"y": -89.49999999999997, "r": 37.849999999999994, "d": 50.0},{"x": 22.55,"y": -81.09999999999997, "r": 25.1, "d": 50.0},{"x": 35.3,"y": -81.09999999999997, "r": 37.849999999999994, "d": 50.0},{"x": 28.925000000000004,"y": -99.99999999999999, "r": 30.200000000000003, "d": 50.0},{"x": 44.22499999999999,"y": -87.39999999999998, "r": 45.499999999999986, "d": 18.0},{"x": 32.75,"y": -81.09999999999997, "r": 35.3, "d": 50.0},{"x": 42.94999999999999,"y": -106.29999999999998, "r": 45.499999999999986, "d": 12.5},{"x": 22.55,"y": -97.89999999999998, "r": 25.1, "d": 50.0},{"x": 40.39999999999999,"y": -118.9, "r": 42.94999999999999, "d": 49.5},{"x": 21.275,"y": -99.99999999999999, "r": 22.55, "d": 50.0},{"x": 45.499999999999986,"y": -110.5, "r": 48.04999999999998, "d": 9.0},{"x": 37.849999999999994,"y": -85.29999999999998, "r": 40.39999999999999, "d": 27.5},{"x": 32.75,"y": -89.49999999999997, "r": 35.3, "d": 50.0},{"x": 32.75,"y": -106.29999999999998, "r": 35.3, "d": 7.0},{"x": 39.12499999999999,"y": -108.39999999999999, "r": 40.39999999999999, "d": 61.0},{"x": 37.849999999999994,"y": -97.89999999999998, "r": 40.39999999999999, "d": 22.0},{"x": 26.375,"y": -104.19999999999999, "r": 27.650000000000002, "d": 23.5},{"x": 36.574999999999996,"y": -112.6, "r": 37.849999999999994, "d": 55.5},{"x": 21.275,"y": -83.19999999999997, "r": 22.55, "d": 50.0},{"x": 42.94999999999999,"y": -81.09999999999997, "r": 45.499999999999986, "d": 99.5},{"x": 30.200000000000003,"y": -106.29999999999998, "r": 32.75, "d": 7.0}]}]}');

//var rawData2 = rawData1
var rawData2 = JSON.parse('{"clusters": [{"centers": [{"x": 44.22499999999999,"y": -93.69999999999999, "r": 45.499999999999986, "d": 1.0},{"x": 28.925000000000004,"y": -81.09999999999997, "r": 30.200000000000003, "d": 1.0},{"x": 34.025,"y": -118.9, "r": 35.3, "d": 2.0},{"x": 34.025,"y": -89.49999999999997, "r": 35.3, "d": 1.0},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 45.499999999999986, "d": 1.0},{"x": 39.12499999999999,"y": -89.49999999999997, "r": 40.39999999999999, "d": 1.0},{"x": 36.574999999999996,"y": -114.69999999999999, "r": 37.849999999999994, "d": 1.0},{"x": 21.275,"y": -102.1, "r": 22.55, "d": 1.0},{"x": 46.774999999999984,"y": -123.1, "r": 48.04999999999998, "d": 1.0},{"x": 39.12499999999999,"y": -85.29999999999998, "r": 40.39999999999999, "d": 1.0},{"x": 36.574999999999996,"y": -118.9, "r": 37.849999999999994, "d": 3.0},{"x": 41.67499999999999,"y": -89.49999999999997, "r": 42.94999999999999, "d": 1.0},{"x": 34.025,"y": -97.89999999999998, "r": 35.3, "d": 2.0},{"x": 28.925000000000004,"y": -93.69999999999999, "r": 30.200000000000003, "d": 1.0},{"x": 26.375,"y": -102.1, "r": 27.650000000000002, "d": 2.0},{"x": 44.22499999999999,"y": -89.49999999999997, "r": 45.499999999999986, "d": 2.0}]}, {"centers": [{"x": 46.774999999999984,"y": -114.69999999999999, "r": 50.59999999999998, "d": 0.04761905},{"x": 42.94999999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 0.16666667},{"x": 22.55,"y": -106.29999999999998, "r": 25.1, "d": 0.045454547},{"x": 35.3,"y": -116.8, "r": 42.94999999999999, "d": 0.25}]}, {"centers": [{"x": 46.774999999999984,"y": -114.69999999999999, "r": 50.59999999999998, "d": 0.04761905},{"x": 42.94999999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 0.16666667},{"x": 22.55,"y": -106.29999999999998, "r": 25.1, "d": 0.045454547},{"x": 35.3,"y": -116.8, "r": 42.94999999999999, "d": 0.25}]}, {"centers": [{"x": 46.774999999999984,"y": -114.69999999999999, "r": 50.59999999999998, "d": 0.04761905},{"x": 42.94999999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 0.16666667},{"x": 22.55,"y": -106.29999999999998, "r": 25.1, "d": 0.045454547},{"x": 36.574999999999996,"y": -116.8, "r": 42.94999999999999, "d": 0.3}]}, {"centers": [{"x": 46.774999999999984,"y": -116.8, "r": 50.59999999999998, "d": 0.055555556},{"x": 42.94999999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 0.16666667},{"x": 36.574999999999996,"y": -116.8, "r": 42.94999999999999, "d": 0.3},{"x": 21.275,"y": -106.29999999999998, "r": 22.55, "d": 0.09090909},{"x": 26.375,"y": -99.99999999999999, "r": 30.200000000000003, "d": 0.16666667}]}, {"centers": [{"x": 36.57499999999999,"y": -97.89999999999998, "r": 50.59999999999998, "d": 0.18181819},{"x": 42.94999999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 0.16666667},{"x": 46.774999999999984,"y": -118.9, "r": 50.59999999999998, "d": 0.06666667},{"x": 32.74999999999999,"y": -104.19999999999999, "r": 42.94999999999999, "d": 0.125},{"x": 36.57499999999999,"y": -93.69999999999999, "r": 50.59999999999998, "d": 0.09090909},{"x": 21.275,"y": -106.29999999999998, "r": 22.55, "d": 0.09090909}]}, {"centers": [{"x": 36.57499999999999,"y": -97.89999999999998, "r": 50.59999999999998, "d": 0.18181819},{"x": 37.849999999999994,"y": -114.69999999999999, "r": 40.39999999999999, "d": 0.2857143},{"x": 42.94999999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 0.16666667},{"x": 36.57499999999999,"y": -93.69999999999999, "r": 50.59999999999998, "d": 0.09090909},{"x": 21.275,"y": -106.29999999999998, "r": 22.55, "d": 0.09090909}]}, {"centers": [{"x": 36.57499999999999,"y": -97.89999999999998, "r": 50.59999999999998, "d": 0.18181819},{"x": 36.57499999999999,"y": -118.9, "r": 50.59999999999998, "d": 0.45454547},{"x": 42.94999999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 0.16666667},{"x": 36.57499999999999,"y": -93.69999999999999, "r": 50.59999999999998, "d": 0.09090909},{"x": 36.57499999999999,"y": -114.69999999999999, "r": 50.59999999999998, "d": 0.09090909},{"x": 21.275,"y": -106.29999999999998, "r": 22.55, "d": 0.09090909}]}, {"centers": [{"x": 26.375,"y": -81.09999999999997, "r": 32.75, "d": 0.2},{"x": 42.94999999999999,"y": -93.69999999999999, "r": 50.59999999999998, "d": 0.16666667},{"x": 21.275,"y": -104.19999999999999, "r": 22.55, "d": 0.125},{"x": 42.94999999999999,"y": -81.09999999999997, "r": 50.59999999999998, "d": 0.16666667},{"x": 21.275,"y": -99.99999999999999, "r": 22.55, "d": 0.125},{"x": 32.74999999999999,"y": -97.89999999999998, "r": 42.94999999999999, "d": 0.25},{"x": 21.275,"y": -108.39999999999999, "r": 22.55, "d": 0.125},{"x": 46.774999999999984,"y": -112.6, "r": 48.04999999999998, "d": 0.125},{"x": 26.375,"y": -112.6, "r": 27.650000000000002, "d": 0.25},{"x": 26.375,"y": -99.99999999999999, "r": 27.650000000000002, "d": 0.25},{"x": 21.275,"y": -112.6, "r": 22.55, "d": 0.125},{"x": 36.574999999999996,"y": -114.69999999999999, "r": 45.499999999999986, "d": 0.14285715},{"x": 40.39999999999999,"y": -85.29999999999998, "r": 50.59999999999998, "d": 0.125}]}, {"centers": [{"x": 36.574999999999996,"y": -114.69999999999999, "r": 42.94999999999999, "d": 0.2},{"x": 45.499999999999986,"y": -81.09999999999997, "r": 50.59999999999998, "d": 0.25},{"x": 46.774999999999984,"y": -114.69999999999999, "r": 48.04999999999998, "d": 0.2},{"x": 28.925000000000004,"y": -97.89999999999998, "r": 30.200000000000003, "d": 0.2},{"x": 26.375,"y": -106.29999999999998, "r": 27.650000000000002, "d": 0.4},{"x": 21.275,"y": -93.69999999999999, "r": 22.55, "d": 0.2},{"x": 21.275,"y": -106.29999999999998, "r": 22.55, "d": 0.2},{"x": 36.574999999999996,"y": -85.29999999999998, "r": 42.94999999999999, "d": 0.2},{"x": 21.275,"y": -102.1, "r": 22.55, "d": 0.2},{"x": 46.774999999999984,"y": -118.9, "r": 48.04999999999998, "d": 0.2},{"x": 21.275,"y": -110.5, "r": 22.55, "d": 0.2},{"x": 39.12499999999999,"y": -97.89999999999998, "r": 40.39999999999999, "d": 0.2},{"x": 44.22499999999999,"y": -123.1, "r": 50.59999999999998, "d": 0.2},{"x": 26.375,"y": -81.09999999999997, "r": 32.75, "d": 0.2},{"x": 45.499999999999986,"y": -93.69999999999999, "r": 50.59999999999998, "d": 0.25},{"x": 21.275,"y": -97.89999999999998, "r": 22.55, "d": 0.2}]}, {"centers": [{"x": 45.499999999999986,"y": -81.09999999999997, "r": 48.04999999999998, "d": 0.5},{"x": 36.574999999999996,"y": -112.6, "r": 37.849999999999994, "d": 0.5},{"x": 28.925000000000004,"y": -91.59999999999998, "r": 30.200000000000003, "d": 0.5},{"x": 21.275,"y": -99.99999999999999, "r": 22.55, "d": 0.5},{"x": 30.200000000000003,"y": -81.09999999999997, "r": 32.75, "d": 0.5},{"x": 35.3,"y": -118.9, "r": 37.849999999999994, "d": 2.5},{"x": 27.650000000000002,"y": -93.69999999999999, "r": 30.200000000000003, "d": 0.5},{"x": 26.375,"y": -104.19999999999999, "r": 27.650000000000002, "d": 1.0},{"x": 28.925000000000004,"y": -83.19999999999997, "r": 30.200000000000003, "d": 0.5},{"x": 37.849999999999994,"y": -89.49999999999997, "r": 40.39999999999999, "d": 0.5},{"x": 28.925000000000004,"y": -95.79999999999998, "r": 30.200000000000003, "d": 0.5},{"x": 34.025,"y": -95.79999999999998, "r": 35.3, "d": 1.0},{"x": 34.025,"y": -87.39999999999998, "r": 35.3, "d": 0.5},{"x": 39.12499999999999,"y": -83.19999999999997, "r": 40.39999999999999, "d": 0.5},{"x": 44.22499999999999,"y": -91.59999999999998, "r": 45.499999999999986, "d": 1.5},{"x": 21.275,"y": -104.19999999999999, "r": 22.55, "d": 0.5},{"x": 34.025,"y": -99.99999999999999, "r": 35.3, "d": 1.0},{"x": 39.12499999999999,"y": -91.59999999999998, "r": 40.39999999999999, "d": 0.5},{"x": 48.04999999999998,"y": -123.1, "r": 50.59999999999998, "d": 0.5},{"x": 26.375,"y": -99.99999999999999, "r": 27.650000000000002, "d": 1.0},{"x": 46.774999999999984,"y": -125.2, "r": 48.04999999999998, "d": 0.5},{"x": 45.499999999999986,"y": -123.1, "r": 48.04999999999998, "d": 0.5},{"x": 32.75,"y": -89.49999999999997, "r": 35.3, "d": 0.5},{"x": 35.3,"y": -89.49999999999997, "r": 37.849999999999994, "d": 0.5},{"x": 37.849999999999994,"y": -114.69999999999999, "r": 40.39999999999999, "d": 0.5},{"x": 46.774999999999984,"y": -121.0, "r": 48.04999999999998, "d": 0.5},{"x": 32.75,"y": -97.89999999999998, "r": 35.3, "d": 1.0},{"x": 30.200000000000003,"y": -93.69999999999999, "r": 32.75, "d": 0.5},{"x": 35.3,"y": -114.69999999999999, "r": 37.849999999999994, "d": 0.5},{"x": 42.94999999999999,"y": -81.09999999999997, "r": 45.499999999999986, "d": 0.5},{"x": 27.650000000000002,"y": -81.09999999999997, "r": 30.200000000000003, "d": 0.5},{"x": 40.39999999999999,"y": -85.29999999999998, "r": 42.94999999999999, "d": 0.5},{"x": 39.12499999999999,"y": -87.39999999999998, "r": 40.39999999999999, "d": 0.5},{"x": 27.650000000000002,"y": -102.1, "r": 30.200000000000003, "d": 1.0},{"x": 42.94999999999999,"y": -89.49999999999997, "r": 45.499999999999986, "d": 1.5},{"x": 25.1,"y": -102.1, "r": 27.650000000000002, "d": 1.0},{"x": 35.3,"y": -97.89999999999998, "r": 37.849999999999994, "d": 1.0},{"x": 37.849999999999994,"y": -85.29999999999998, "r": 40.39999999999999, "d": 0.5}]}]}');
var rawData3 = JSON.parse('{"clusters": [{"centers": [{"x": 39.12499999999999,"y": -85.29999999999998, "r": 40.39999999999999, "d": 101.0},{"x": 21.275,"y": -93.69999999999999, "r": 22.55, "d": 15.0},{"x": 34.025,"y": -123.1, "r": 35.3, "d": 23.0},{"x": 44.22499999999999,"y": -85.29999999999998, "r": 45.499999999999986, "d": 100.0},{"x": 49.32499999999998,"y": -114.69999999999999, "r": 50.59999999999998, "d": 12.0},{"x": 28.925000000000004,"y": -102.1, "r": 30.200000000000003, "d": 100.0},{"x": 31.475,"y": -114.69999999999999, "r": 32.75, "d": 100.0},{"x": 34.025,"y": -81.09999999999997, "r": 35.3, "d": 100.0},{"x": 41.67499999999999,"y": -102.1, "r": 42.94999999999999, "d": 10.0},{"x": 41.67499999999999,"y": -85.29999999999998, "r": 42.94999999999999, "d": 100.0},{"x": 44.22499999999999,"y": -106.29999999999998, "r": 45.499999999999986, "d": 31.0},{"x": 23.825000000000003,"y": -81.09999999999997, "r": 25.1, "d": 100.0},{"x": 44.22499999999999,"y": -110.5, "r": 45.499999999999986, "d": 57.0},{"x": 28.925000000000004,"y": -89.49999999999997, "r": 30.200000000000003, "d": 100.0},{"x": 36.574999999999996,"y": -85.29999999999998, "r": 37.849999999999994, "d": 100.0},{"x": 39.12499999999999,"y": -110.5, "r": 40.39999999999999, "d": 99.0},{"x": 21.275,"y": -89.49999999999997, "r": 22.55, "d": 92.0},{"x": 41.67499999999999,"y": -97.89999999999998, "r": 42.94999999999999, "d": 98.0},{"x": 39.12499999999999,"y": -118.9, "r": 40.39999999999999, "d": 100.0},{"x": 34.025,"y": -114.69999999999999, "r": 35.3, "d": 100.0},{"x": 41.67499999999999,"y": -81.09999999999997, "r": 42.94999999999999, "d": 100.0},{"x": 41.67499999999999,"y": -106.29999999999998, "r": 42.94999999999999, "d": 74.0},{"x": 36.574999999999996,"y": -102.1, "r": 37.849999999999994, "d": 16.0},{"x": 46.774999999999984,"y": -93.69999999999999, "r": 48.04999999999998, "d": 100.0},{"x": 23.825000000000003,"y": -110.5, "r": 25.1, "d": 80.0},{"x": 49.32499999999998,"y": -85.29999999999998, "r": 50.59999999999998, "d": 100.0},{"x": 28.925000000000004,"y": -93.69999999999999, "r": 30.200000000000003, "d": 100.0},{"x": 39.12499999999999,"y": -123.1, "r": 40.39999999999999, "d": 100.0},{"x": 21.275,"y": -106.29999999999998, "r": 22.55, "d": 100.0},{"x": 39.12499999999999,"y": -102.1, "r": 40.39999999999999, "d": 56.0},{"x": 49.32499999999998,"y": -127.30000000000001, "r": 50.59999999999998, "d": 9.0},{"x": 44.22499999999999,"y": -123.1, "r": 45.499999999999986, "d": 100.0},{"x": 46.774999999999984,"y": -123.1, "r": 48.04999999999998, "d": 100.0},{"x": 39.12499999999999,"y": -97.89999999999998, "r": 40.39999999999999, "d": 100.0},{"x": 44.22499999999999,"y": -93.69999999999999, "r": 45.499999999999986, "d": 100.0}]}, {"centers": [{"x": 26.375,"y": -112.6, "r": 30.200000000000003, "d": 7.7083335},{"x": 48.04999999999998,"y": -121.0, "r": 50.59999999999998, "d": 15.125},{"x": 41.67499999999999,"y": -102.1, "r": 50.59999999999998, "d": 18.333334},{"x": 39.12499999999999,"y": -121.0, "r": 42.94999999999999, "d": 8.333333},{"x": 34.02499999999999,"y": -83.19999999999997, "r": 48.04999999999998, "d": 9.136364}]}, {"centers": [{"x": 26.375,"y": -112.6, "r": 30.200000000000003, "d": 7.7083335},{"x": 48.04999999999998,"y": -121.0, "r": 50.59999999999998, "d": 15.125},{"x": 41.67499999999999,"y": -102.1, "r": 50.59999999999998, "d": 18.333334},{"x": 39.12499999999999,"y": -121.0, "r": 42.94999999999999, "d": 8.333333},{"x": 34.02499999999999,"y": -83.19999999999997, "r": 48.04999999999998, "d": 9.136364}]}, {"centers": [{"x": 27.650000000000002,"y": -112.6, "r": 30.200000000000003, "d": 6.25},{"x": 48.04999999999998,"y": -121.0, "r": 50.59999999999998, "d": 15.125},{"x": 41.67499999999999,"y": -102.1, "r": 50.59999999999998, "d": 18.333334},{"x": 30.200000000000003,"y": -112.6, "r": 32.75, "d": 6.25},{"x": 39.12499999999999,"y": -121.0, "r": 42.94999999999999, "d": 8.333333},{"x": 34.02499999999999,"y": -83.19999999999997, "r": 48.04999999999998, "d": 9.136364}]}, {"centers": [{"x": 42.94999999999999,"y": -106.29999999999998, "r": 50.59999999999998, "d": 17.5},{"x": 41.67499999999999,"y": -99.99999999999999, "r": 50.59999999999998, "d": 20.0},{"x": 48.04999999999998,"y": -121.0, "r": 50.59999999999998, "d": 15.125},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 48.04999999999998, "d": 33.333332},{"x": 30.200000000000003,"y": -112.6, "r": 32.75, "d": 6.25},{"x": 25.1,"y": -83.19999999999997, "r": 30.200000000000003, "d": 12.5},{"x": 39.12499999999999,"y": -121.0, "r": 42.94999999999999, "d": 8.333333},{"x": 27.650000000000002,"y": -112.6, "r": 30.200000000000003, "d": 6.25}]}, {"centers": [{"x": 42.94999999999999,"y": -106.29999999999998, "r": 50.59999999999998, "d": 17.5},{"x": 41.67499999999999,"y": -99.99999999999999, "r": 50.59999999999998, "d": 20.0},{"x": 48.04999999999998,"y": -121.0, "r": 50.59999999999998, "d": 15.125},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 48.04999999999998, "d": 33.333332},{"x": 30.200000000000003,"y": -112.6, "r": 32.75, "d": 6.25},{"x": 25.1,"y": -83.19999999999997, "r": 30.200000000000003, "d": 12.5},{"x": 39.12499999999999,"y": -121.0, "r": 42.94999999999999, "d": 8.333333},{"x": 27.650000000000002,"y": -112.6, "r": 30.200000000000003, "d": 6.25}]}, {"centers": [{"x": 42.94999999999999,"y": -106.29999999999998, "r": 50.59999999999998, "d": 17.5},{"x": 41.67499999999999,"y": -99.99999999999999, "r": 50.59999999999998, "d": 20.0},{"x": 48.04999999999998,"y": -121.0, "r": 50.59999999999998, "d": 15.125},{"x": 27.650000000000002,"y": -108.39999999999999, "r": 30.200000000000003, "d": 8.333333},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 48.04999999999998, "d": 33.333332},{"x": 31.475,"y": -112.6, "r": 32.75, "d": 12.5},{"x": 25.1,"y": -83.19999999999997, "r": 30.200000000000003, "d": 12.5},{"x": 39.12499999999999,"y": -121.0, "r": 42.94999999999999, "d": 8.333333}]}, {"centers": [{"x": 42.94999999999999,"y": -106.29999999999998, "r": 50.59999999999998, "d": 17.5},{"x": 45.499999999999986,"y": -102.1, "r": 50.59999999999998, "d": 2.5},{"x": 48.04999999999998,"y": -121.0, "r": 50.59999999999998, "d": 15.125},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 48.04999999999998, "d": 33.333332},{"x": 49.32499999999998,"y": -89.49999999999997, "r": 50.59999999999998, "d": 20.8},{"x": 37.849999999999994,"y": -121.0, "r": 40.39999999999999, "d": 12.5},{"x": 31.475,"y": -112.6, "r": 32.75, "d": 12.5},{"x": 25.1,"y": -83.19999999999997, "r": 30.200000000000003, "d": 12.5},{"x": 40.39999999999999,"y": -121.0, "r": 42.94999999999999, "d": 12.5},{"x": 42.94999999999999,"y": -93.69999999999999, "r": 45.499999999999986, "d": 33.0},{"x": 23.825000000000003,"y": -108.39999999999999, "r": 27.650000000000002, "d": 30.0}]}, {"centers": [{"x": 42.94999999999999,"y": -106.29999999999998, "r": 50.59999999999998, "d": 17.5},{"x": 45.499999999999986,"y": -102.1, "r": 50.59999999999998, "d": 2.5},{"x": 48.04999999999998,"y": -121.0, "r": 50.59999999999998, "d": 15.125},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 48.04999999999998, "d": 33.333332},{"x": 49.32499999999998,"y": -89.49999999999997, "r": 50.59999999999998, "d": 20.8},{"x": 37.849999999999994,"y": -121.0, "r": 40.39999999999999, "d": 12.5},{"x": 31.475,"y": -112.6, "r": 32.75, "d": 12.5},{"x": 25.1,"y": -83.19999999999997, "r": 30.200000000000003, "d": 12.5},{"x": 40.39999999999999,"y": -121.0, "r": 42.94999999999999, "d": 12.5},{"x": 42.94999999999999,"y": -93.69999999999999, "r": 45.499999999999986, "d": 33.0},{"x": 23.825000000000003,"y": -108.39999999999999, "r": 27.650000000000002, "d": 30.0}]}, {"centers": [{"x": 25.1,"y": -81.09999999999997, "r": 30.200000000000003, "d": 25.0},{"x": 39.12499999999999,"y": -102.1, "r": 40.39999999999999, "d": 51.0},{"x": 46.774999999999984,"y": -123.1, "r": 48.04999999999998, "d": 33.333332},{"x": 21.275,"y": -91.59999999999998, "r": 22.55, "d": 26.75},{"x": 22.55,"y": -108.39999999999999, "r": 25.1, "d": 45.0},{"x": 49.32499999999998,"y": -121.0, "r": 50.59999999999998, "d": 5.25},{"x": 44.22499999999999,"y": -81.09999999999997, "r": 48.04999999999998, "d": 33.333332},{"x": 49.32499999999998,"y": -89.49999999999997, "r": 50.59999999999998, "d": 20.8},{"x": 28.924999999999997,"y": -102.1, "r": 35.3, "d": 20.0},{"x": 39.12499999999999,"y": -85.29999999999998, "r": 40.39999999999999, "d": 33.666668},{"x": 42.94999999999999,"y": -95.79999999999998, "r": 45.499999999999986, "d": 49.5},{"x": 31.474999999999998,"y": -93.69999999999999, "r": 37.849999999999994, "d": 20.0},{"x": 28.924999999999997,"y": -89.49999999999997, "r": 35.3, "d": 20.0},{"x": 31.474999999999998,"y": -89.49999999999997, "r": 37.849999999999994, "d": 20.0},{"x": 28.924999999999997,"y": -123.1, "r": 35.3, "d": 4.6},{"x": 39.12499999999999,"y": -121.0, "r": 40.39999999999999, "d": 25.0},{"x": 45.499999999999986,"y": -106.29999999999998, "r": 50.59999999999998, "d": 26.25},{"x": 44.22499999999999,"y": -116.8, "r": 45.499999999999986, "d": 39.25},{"x": 28.924999999999997,"y": -93.69999999999999, "r": 35.3, "d": 20.0},{"x": 31.474999999999998,"y": -114.69999999999999, "r": 37.849999999999994, "d": 20.0}]}, {"centers": [{"x": 37.849999999999994,"y": -102.1, "r": 40.39999999999999, "d": 36.0},{"x": 21.275,"y": -108.39999999999999, "r": 22.55, "d": 50.0},{"x": 22.55,"y": -106.29999999999998, "r": 25.1, "d": 50.0},{"x": 28.925000000000004,"y": -99.99999999999999, "r": 30.200000000000003, "d": 50.0},{"x": 21.275,"y": -91.59999999999998, "r": 22.55, "d": 53.5},{"x": 39.12499999999999,"y": -108.39999999999999, "r": 40.39999999999999, "d": 49.5},{"x": 27.650000000000002,"y": -93.69999999999999, "r": 30.200000000000003, "d": 50.0},{"x": 42.94999999999999,"y": -106.29999999999998, "r": 45.499999999999986, "d": 52.5},{"x": 44.22499999999999,"y": -95.79999999999998, "r": 45.499999999999986, "d": 50.0},{"x": 34.025,"y": -116.8, "r": 35.3, "d": 50.0},{"x": 42.94999999999999,"y": -93.69999999999999, "r": 45.499999999999986, "d": 50.0},{"x": 34.025,"y": -125.2, "r": 35.3, "d": 11.5},{"x": 48.04999999999998,"y": -85.29999999999998, "r": 50.59999999999998, "d": 50.0},{"x": 46.774999999999984,"y": -121.0, "r": 48.04999999999998, "d": 50.0},{"x": 23.825000000000003,"y": -112.6, "r": 25.1, "d": 42.5},{"x": 44.22499999999999,"y": -125.2, "r": 45.499999999999986, "d": 50.0},{"x": 40.39999999999999,"y": -110.5, "r": 42.94999999999999, "d": 49.5},{"x": 46.774999999999984,"y": -125.2, "r": 48.04999999999998, "d": 50.0},{"x": 25.1,"y": -81.09999999999997, "r": 27.650000000000002, "d": 50.0},{"x": 42.94999999999999,"y": -123.1, "r": 45.499999999999986, "d": 50.0},{"x": 35.3,"y": -114.69999999999999, "r": 37.849999999999994, "d": 50.0},{"x": 30.200000000000003,"y": -93.69999999999999, "r": 32.75, "d": 50.0},{"x": 23.825000000000003,"y": -83.19999999999997, "r": 25.1, "d": 50.0},{"x": 49.32499999999998,"y": -87.39999999999998, "r": 50.59999999999998, "d": 50.0},{"x": 37.849999999999994,"y": -123.1, "r": 40.39999999999999, "d": 50.0},{"x": 28.925000000000004,"y": -95.79999999999998, "r": 30.200000000000003, "d": 50.0},{"x": 28.925000000000004,"y": -87.39999999999998, "r": 30.200000000000003, "d": 50.0},{"x": 44.22499999999999,"y": -87.39999999999998, "r": 45.499999999999986, "d": 50.0},{"x": 48.04999999999998,"y": -93.69999999999999, "r": 50.59999999999998, "d": 52.0},{"x": 48.04999999999998,"y": -123.1, "r": 50.59999999999998, "d": 50.0},{"x": 30.200000000000003,"y": -102.1, "r": 32.75, "d": 50.0},{"x": 34.025,"y": -83.19999999999997, "r": 35.3, "d": 50.0},{"x": 30.200000000000003,"y": -114.69999999999999, "r": 32.75, "d": 50.0},{"x": 48.04999999999998,"y": -114.69999999999999, "r": 50.59999999999998, "d": 6.0},{"x": 22.55,"y": -81.09999999999997, "r": 25.1, "d": 50.0},{"x": 31.475,"y": -116.8, "r": 32.75, "d": 50.0},{"x": 32.75,"y": -123.1, "r": 35.3, "d": 11.5},{"x": 39.12499999999999,"y": -116.8, "r": 40.39999999999999, "d": 50.0},{"x": 44.22499999999999,"y": -83.19999999999997, "r": 45.499999999999986, "d": 50.0},{"x": 37.849999999999994,"y": -118.9, "r": 40.39999999999999, "d": 50.0},{"x": 45.499999999999986,"y": -85.29999999999998, "r": 48.04999999999998, "d": 50.0},{"x": 45.499999999999986,"y": -110.5, "r": 48.04999999999998, "d": 28.5},{"x": 40.39999999999999,"y": -123.1, "r": 42.94999999999999, "d": 50.0},{"x": 49.32499999999998,"y": -112.6, "r": 50.59999999999998, "d": 6.0},{"x": 44.22499999999999,"y": -121.0, "r": 45.499999999999986, "d": 50.0},{"x": 28.925000000000004,"y": -104.19999999999999, "r": 30.200000000000003, "d": 50.0},{"x": 35.3,"y": -81.09999999999997, "r": 37.849999999999994, "d": 50.0},{"x": 39.12499999999999,"y": -125.2, "r": 40.39999999999999, "d": 50.0},{"x": 32.75,"y": -81.09999999999997, "r": 35.3, "d": 50.0},{"x": 40.39999999999999,"y": -85.29999999999998, "r": 42.94999999999999, "d": 100.5},{"x": 44.22499999999999,"y": -91.59999999999998, "r": 45.499999999999986, "d": 50.0},{"x": 39.12499999999999,"y": -121.0, "r": 40.39999999999999, "d": 50.0},{"x": 30.200000000000003,"y": -89.49999999999997, "r": 32.75, "d": 50.0},{"x": 31.475,"y": -112.6, "r": 32.75, "d": 50.0},{"x": 28.925000000000004,"y": -91.59999999999998, "r": 30.200000000000003, "d": 50.0},{"x": 40.39999999999999,"y": -118.9, "r": 42.94999999999999, "d": 50.0},{"x": 21.275,"y": -104.19999999999999, "r": 22.55, "d": 50.0},{"x": 27.650000000000002,"y": -89.49999999999997, "r": 30.200000000000003, "d": 50.0},{"x": 49.32499999999998,"y": -83.19999999999997, "r": 50.59999999999998, "d": 50.0},{"x": 44.22499999999999,"y": -112.6, "r": 45.499999999999986, "d": 28.5},{"x": 37.849999999999994,"y": -110.5, "r": 40.39999999999999, "d": 49.5},{"x": 45.499999999999986,"y": -123.1, "r": 48.04999999999998, "d": 50.0},{"x": 34.025,"y": -112.6, "r": 35.3, "d": 50.0},{"x": 42.94999999999999,"y": -81.09999999999997, "r": 45.499999999999986, "d": 50.0},{"x": 27.650000000000002,"y": -102.1, "r": 30.200000000000003, "d": 50.0},{"x": 49.32499999999998,"y": -127.30000000000001, "r": 50.59999999999998, "d": 9.0},{"x": 32.75,"y": -114.69999999999999, "r": 35.3, "d": 50.0},{"x": 37.849999999999994,"y": -85.29999999999998, "r": 40.39999999999999, "d": 100.5},{"x": 49.32499999999998,"y": -116.8, "r": 50.59999999999998, "d": 6.0},{"x": 40.39999999999999,"y": -97.89999999999998, "r": 42.94999999999999, "d": 99.0}]}]}');

var data = JSON.parse('{"clusters":[{"centers": [{ "x": 250, "y": 40, "r": 10 }, { "x": 40, "y": 75, "r": 43 }]}, {"centers": [{ "x": 759, "y": 255, "r": 36 }]}, {"centers": [{ "x": 50, "y": 40, "r": 10 }, { "x": 60, "y": 20, "r": 10 }]}, {"centers": [{ "x": 133, "y": 54, "r": 12 }, { "x": 40, "y": 75, "r": 43 }]}, {"centers":[{ "x": 260, "y": 120, "r": 10 }, { "x": 40, "y": 75, "r": 13 }, { "x": 33, "y": 54, "r": 12 }]}]}');

  //Graphical environnement
var graph = document.getElementById("map").getElementsByTagName("svg")[0].appendChild(po.svg("g"));


function cluster(view_center, zoom, data) {
  rawData1 = JSON.parse(data); update2();
  if(view_center) map.center(view_center);
  if(zoom) map.zoom(zoom);
}
//Translating function 
  /*@brief: Transforms the raw data in pixels
    @expects: [{x, y, r}, {x,y,r}...]
  */
function generateData(centers){
  var res = [];
  for(var i = 0; i < centers.length; i++) {
    var e = centers[i];
    var bitch = JSON.parse('{"x": '+e.r+', "y": '+e.y+'}');
    var border = geoToPx(bitch);
    var toPix = geoToPx(e);
    var diff = border.y - toPix.y;
    var nR = Math.abs(border.y - toPix.y);
    
    res.push(JSON.parse('{"x":'+toPix.x+', "y":'+toPix.y+', "r": '+nR+', "d": '+e.d+'}'));
    
  }
  return res;
}

//Functions to draw
  //Expects input of the form {"x": _, "y": _, "r": _}
var colors = ["", "LightCoral", "RoyalBlue", "Purple"]
function drawCircle(entry, colorID) {
  console.log("color here: "+colorID)
  var point = graph.appendChild(po.svg("circle"));
  console.log("chingjjv"+colorID)
  point.setAttribute('style', 'fill:'+ colors[colorID] +"; "+point.getAttribute("fill"));
  point.setAttribute('style', 'opacity:'+entry.d / 100+"; "+point.getAttribute("style"));
  point.setAttribute("cx", entry.x);
  point.setAttribute("cy", entry.y);
  point.setAttribute("r", entry.r);
}

  //Goes through the list of centers at one level
function drawCenters(clusts, colorID){
  console.log("color: "+colorID)
  for(var i = 0; i < clusts.length; i++) {
    console.log("color: "+colorID)
    drawCircle(clusts[i], colorID);
  }
}


//Helper functions
  //Translates pixels {"x": _, "y":_, "r":_ } into geolocation 
  //using only the x and y attribute; Returns {"lat":_, "lon":_}
function pxToGeo(pt){
  return map.pointLocation(JSON.parse('{"x":'+ pt.x+', "y": '+pt.y+'}'));
}

  //Translates geolocation {"lat": _, "lon":_} into pixel {"x":_, "y": _}
function geoToPx(pt){
  //Trouble parsing here
  return map.locationPoint(JSON.parse('{ "lat":'+pt.x+', "lon": '+pt.y+'}'));
}

function update2() {
  //custers: 0 (more details) ->  9
  //zoom level:  3 (far zoom) -> 10
  while(graph.firstChild){
    graph.removeChild(graph.firstChild);
  }
  drawCenters(generateData(rawData1.clusters[10 - Math.floor(map.zoom())].centers), 1);
  drawCenters(generateData(rawData2.clusters[10 - Math.floor(map.zoom())].centers), 2);
  drawCenters(generateData(rawData3.clusters[10 - Math.floor(map.zoom())].centers), 3);
}


  //Tests drawCenters
drawCenters(generateData(rawData1.clusters[0].centers), 1);
drawCenters(generateDate(rawData2.clusters[0].centers), 2);
drawCenters(generateDate(rawData3.clusters[0].centers), 3);  
  //Tests
var res = geoToPx(JSON.parse('{"x": 37.787, "y": -122.228}'));
var res2 = geoToPx(JSON.parse('{"x": 37.787, "y": -132.228}'));
//var res2 = pxToGeo(JSON.parse('{"x": 758.9, "y": 160}'));
console.log("The x: "+res.x+" the y: "+res.y);
console.log("The x2:"+res2.x+" the y2 "+res2.y);

//drawCircle(JSON.parse('{"x": 0, "y": 300, "r": 30}'))

